<!doctype html><html lang=en class=no-js>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=generator content="Hugo 0.88.1"><meta name=ROBOTS content="INDEX, FOLLOW">
<link rel="shortcut icon" href=/favicons/favicon.ico>
<link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180>
<link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16>
<link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36>
<link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48>
<link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72>
<link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96>
<link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144>
<link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192>
<title>Adding Soft Actor-Critic | Spice.ai blog</title>
<meta name=description content="Last month in the v0.5-alpha version, a new learning algorithm was added to Spice.ai: Soft Actor-Critic. This is a very popular algorithm in the …">
<meta property="og:title" content="Adding Soft Actor-Critic">
<meta property="og:description" content="Last month in the v0.5-alpha version, a new learning algorithm was added to Spice.ai: Soft Actor-Critic. This is a very popular algorithm in the Reinforcement Learning field. Let&rsquo;s see what it is and why this is an interesting addition.
The previous article Understanding Q-learning: How a Reward Is All You Need is not necessary but can be helpful to understand this article.
What is Soft Actor-Critic Actor-Critic Deepmind first introduced the actor-critic approach in deep learning in a 2016 paper.">
<meta property="og:type" content="article">
<meta property="og:url" content="/posts/2022/01/12/adding-soft-actor-critic/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2022-01-12T00:00:00+00:00">
<meta property="article:modified_time" content="2022-01-12T11:04:34+09:00">
<meta itemprop=name content="Adding Soft Actor-Critic">
<meta itemprop=description content="Last month in the v0.5-alpha version, a new learning algorithm was added to Spice.ai: Soft Actor-Critic. This is a very popular algorithm in the Reinforcement Learning field. Let&rsquo;s see what it is and why this is an interesting addition.
The previous article Understanding Q-learning: How a Reward Is All You Need is not necessary but can be helpful to understand this article.
What is Soft Actor-Critic Actor-Critic Deepmind first introduced the actor-critic approach in deep learning in a 2016 paper."><meta itemprop=datePublished content="2022-01-12T00:00:00+00:00">
<meta itemprop=dateModified content="2022-01-12T11:04:34+09:00">
<meta itemprop=wordCount content="994">
<meta itemprop=keywords content="actor-critic,"><meta name=twitter:card content="summary">
<meta name=twitter:title content="Adding Soft Actor-Critic">
<meta name=twitter:description content="Last month in the v0.5-alpha version, a new learning algorithm was added to Spice.ai: Soft Actor-Critic. This is a very popular algorithm in the Reinforcement Learning field. Let&rsquo;s see what it is and why this is an interesting addition.
The previous article Understanding Q-learning: How a Reward Is All You Need is not necessary but can be helpful to understand this article.
What is Soft Actor-Critic Actor-Critic Deepmind first introduced the actor-critic approach in deep learning in a 2016 paper.">
<link rel=preload href=/scss/main.min.a648fb06ee87fb08d4b2d5698675182cab33629f1bbc21e5e592a9261834a71d.css as=style>
<link href=/scss/main.min.a648fb06ee87fb08d4b2d5698675182cab33629f1bbc21e5e592a9261834a71d.css rel=stylesheet integrity>
<script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
</head>
<body class="td-page td-blog">
<header>
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
<a class=navbar-brand href=/>
<span class=navbar-logo></span><span class="text-uppercase font-weight-bold">Spice.ai blog</span>
</a>
<div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar>
<ul class="navbar-nav mt-2 mt-lg-0">
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=https://github.com/spiceai/spiceai target=_blank><span>GitHub</span></a>
</li>
</ul>
</div>
<div class="navbar-nav d-none d-lg-block">
</div>
</nav>
</header>
<div class="container-fluid td-outer">
<div class=td-main>
<div class="row flex-xl-nowrap">
<aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
<div id=td-sidebar-menu class=td-sidebar__inner>
<form class="td-sidebar__search d-flex align-items-center">
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation">
</button>
</form>
<nav class="collapse td-sidebar-nav" id=td-section-nav>
<ul class="td-sidebar-nav__section pr-md-3 ul-0">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-posts-li>
<a href=/posts/ title="Spice.ai blog" class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-posts><span>Blog</span></a>
<ul class=ul-1>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-posts20220208announcing-the-release-of-spiceai-v06-alpha-li>
<a href=/posts/2022/02/08/announcing-the-release-of-spice.ai-v0.6-alpha/ title="Announcing the release of Spice.ai v0.6-alpha" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-posts20220208announcing-the-release-of-spiceai-v06-alpha><span>Spice.ai v0.6-alpha is now available</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-posts20220112adding-soft-actor-critic-li>
<a href=/posts/2022/01/12/adding-soft-actor-critic/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-posts20220112adding-soft-actor-critic><span class=td-sidebar-nav-active-item>Adding Soft Actor-Critic</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-posts20220104what-data-informs-ai-driven-decision-making-li>
<a href=/posts/2022/01/04/what-data-informs-ai-driven-decision-making/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-posts20220104what-data-informs-ai-driven-decision-making><span>What Data Informs AI-driven Decision Making?</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-posts20211230a-new-class-of-applications-that-learn-and-adapt-li>
<a href=/posts/2021/12/30/a-new-class-of-applications-that-learn-and-adapt/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-posts20211230a-new-class-of-applications-that-learn-and-adapt><span>A New Class of Applications That Learn and Adapt</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-posts20211228announcing-the-release-of-spiceai-v051-alpha-li>
<a href=/posts/2021/12/28/announcing-the-release-of-spice.ai-v0.5.1-alpha/ title="Announcing the release of Spice.ai v0.5.1-alpha" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-posts20211228announcing-the-release-of-spiceai-v051-alpha><span>Spice.ai v0.5.1-alpha is now available</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-posts20211215understanding-q-learning-how-a-reward-is-all-you-need-li>
<a href=/posts/2021/12/15/understanding-q-learning-how-a-reward-is-all-you-need/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-posts20211215understanding-q-learning-how-a-reward-is-all-you-need><span>Understanding Q-learning: How a Reward Is All You Need</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-posts20211206announcing-the-release-of-spiceai-v05-alpha-li>
<a href=/posts/2021/12/06/announcing-the-release-of-spice.ai-v0.5-alpha/ title="Announcing the release of Spice.ai v0.5-alpha" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-posts20211206announcing-the-release-of-spiceai-v05-alpha><span>Spice.ai v0.5-alpha is now available</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-posts20211205ai-needs-ai-ready-data-li>
<a href=/posts/2021/12/05/ai-needs-ai-ready-data/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-posts20211205ai-needs-ai-ready-data><span>AI needs AI-ready data</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-posts20211202spicepods-from-zero-to-hero-li>
<a href=/posts/2021/12/02/spicepods-from-zero-to-hero/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-posts20211202spicepods-from-zero-to-hero><span>Spicepods: From Zero To Hero</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-posts20211122announcing-the-release-of-spiceai-v041-alpha-li>
<a href=/posts/2021/11/22/announcing-the-release-of-spice.ai-v0.4.1-alpha/ title="Announcing the release of Spice.ai v0.4.1-alpha" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-posts20211122announcing-the-release-of-spiceai-v041-alpha><span>Spice.ai v0.4.1-alpha is now available</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-posts20211118spiceais-approach-to-time-series-ai-li>
<a href=/posts/2021/11/18/spice.ais-approach-to-time-series-ai/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-posts20211118spiceais-approach-to-time-series-ai><span>Spice.ai's approach to Time-Series AI</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-posts20211115announcing-the-release-of-spiceai-v04-alpha-li>
<a href=/posts/2021/11/15/announcing-the-release-of-spice.ai-v0.4-alpha/ title="Announcing the release of Spice.ai v0.4-alpha" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-posts20211115announcing-the-release-of-spiceai-v04-alpha><span>Spice.ai v0.4-alpha is now available</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-posts20211115teaching-apps-how-to-learn-with-spicepods-li>
<a href=/posts/2021/11/15/teaching-apps-how-to-learn-with-spicepods/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-posts20211115teaching-apps-how-to-learn-with-spicepods><span>Teaching Apps how to Learn with Spicepods</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-posts20211105making-apps-that-learn-and-adapt-li>
<a href=/posts/2021/11/05/making-apps-that-learn-and-adapt/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-posts20211105making-apps-that-learn-and-adapt><span>Making Apps That Learn And Adapt</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-posts20211102announcing-the-release-of-spiceai-v031-alpha-li>
<a href=/posts/2021/11/02/announcing-the-release-of-spice.ai-v0.3.1-alpha/ title="Announcing the release of Spice.ai v0.3.1-alpha" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-posts20211102announcing-the-release-of-spiceai-v031-alpha><span>Spice.ai v0.3.1-alpha is now available</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-posts20211026spiceai-v03-alpha-is-now-available-li>
<a href=/posts/2021/10/26/spice.ai-v0.3-alpha-is-now-available/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-posts20211026spiceai-v03-alpha-is-now-available><span>Spice.ai v0.3-alpha is now available</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-posts20211012announcing-the-release-of-spiceai-v021-alpha-li>
<a href=/posts/2021/10/12/announcing-the-release-of-spice.ai-v0.2.1-alpha/ title="Announcing the release of Spice.ai v0.2.1-alpha" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-posts20211012announcing-the-release-of-spiceai-v021-alpha><span>Spice.ai v0.2.1-alpha is now available</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-posts20211004spiceai-v02-alpha-is-now-available-li>
<a href=/posts/2021/10/04/spice.ai-v0.2-alpha-is-now-available/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-posts20211004spiceai-v02-alpha-is-now-available><span>Spice.ai v0.2-alpha is now available</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-posts20210907introducing-spiceai-open-source-time-series-ai-for-developers-li>
<a href=/posts/2021/09/07/introducing-spice.ai-open-source-time-series-ai-for-developers/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-posts20210907introducing-spiceai-open-source-time-series-ai-for-developers><span>Introducing Spice.ai - open source, time series AI for developers</span></a>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</aside>
<aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
<a id=print href=/posts/_print/><i class="fa fa-print fa-fw"></i> Print entire section</a>
</div>
<div class=td-toc><nav id=TableOfContents>
<ul>
<li><a href=#what-is-soft-actor-critic>What is Soft Actor-Critic</a>
<ul>
<li><a href=#actor-critic>Actor-Critic</a></li>
<li><a href=#soft-actor-critic>Soft Actor-Critic</a></li>
</ul>
</li>
<li><a href=#adding-choices-to-spiceai-learning-algorithms>Adding choices to Spice.AI learning algorithms</a></li>
<li><a href=#implementation-in-the-source-code>Implementation in the source code</a></li>
<li><a href=#conclusion>Conclusion</a></li>
</ul>
</nav></div>
<div class="taxonomy taxonomy-terms-cloud taxo-categories">
<h5 class=taxonomy-title>Categories</h5>
<ul class=taxonomy-terms>
<li><a class=taxonomy-term href=/categories/applications/ data-taxonomy-term=applications><span class=taxonomy-label>applications</span><span class=taxonomy-count>4</span></a></li>
<li><a class=taxonomy-term href=/categories/data/ data-taxonomy-term=data><span class=taxonomy-label>data</span><span class=taxonomy-count>2</span></a></li>
<li><a class=taxonomy-term href=/categories/data-engineering/ data-taxonomy-term=data-engineering><span class=taxonomy-label>data engineering</span><span class=taxonomy-count>1</span></a></li>
<li><a class=taxonomy-term href=/categories/deep-learning/ data-taxonomy-term=deep-learning><span class=taxonomy-label>deep learning</span><span class=taxonomy-count>2</span></a></li>
<li><a class=taxonomy-term href=/categories/learn-and-adapt/ data-taxonomy-term=learn-and-adapt><span class=taxonomy-label>learn-and-adapt</span><span class=taxonomy-count>4</span></a></li>
<li><a class=taxonomy-term href=/categories/reinforcement-learning/ data-taxonomy-term=reinforcement-learning><span class=taxonomy-label>reinforcement learning</span><span class=taxonomy-count>3</span></a></li>
<li><a class=taxonomy-term href=/categories/release/ data-taxonomy-term=release><span class=taxonomy-label>release</span><span class=taxonomy-count>9</span></a></li>
<li><a class=taxonomy-term href=/categories/time-series-ai/ data-taxonomy-term=time-series-ai><span class=taxonomy-label>time-series ai</span><span class=taxonomy-count>1</span></a></li>
</ul>
</div>
<div class="taxonomy taxonomy-terms-cloud taxo-tags">
<h5 class=taxonomy-title>Tags</h5>
<ul class=taxonomy-terms>
<li><a class=taxonomy-term href=/tags/actor-critic/ data-taxonomy-term=actor-critic><span class=taxonomy-label>actor-critic</span><span class=taxonomy-count>1</span></a></li>
<li><a class=taxonomy-term href=/tags/agile-ml/ data-taxonomy-term=agile-ml><span class=taxonomy-label>agile ml</span><span class=taxonomy-count>4</span></a></li>
<li><a class=taxonomy-term href=/tags/arrow/ data-taxonomy-term=arrow><span class=taxonomy-label>arrow</span><span class=taxonomy-count>1</span></a></li>
<li><a class=taxonomy-term href=/tags/categorical-data/ data-taxonomy-term=categorical-data><span class=taxonomy-label>categorical data</span><span class=taxonomy-count>1</span></a></li>
<li><a class=taxonomy-term href=/tags/cnn/ data-taxonomy-term=cnn><span class=taxonomy-label>cnn</span><span class=taxonomy-count>1</span></a></li>
<li><a class=taxonomy-term href=/tags/dashboard/ data-taxonomy-term=dashboard><span class=taxonomy-label>dashboard</span><span class=taxonomy-count>1</span></a></li>
<li><a class=taxonomy-term href=/tags/data/ data-taxonomy-term=data><span class=taxonomy-label>data</span><span class=taxonomy-count>3</span></a></li>
<li><a class=taxonomy-term href=/tags/dataspaces/ data-taxonomy-term=dataspaces><span class=taxonomy-label>dataspaces</span><span class=taxonomy-count>1</span></a></li>
<li><a class=taxonomy-term href=/tags/decision-engines/ data-taxonomy-term=decision-engines><span class=taxonomy-label>decision engines</span><span class=taxonomy-count>2</span></a></li>
<li><a class=taxonomy-term href=/tags/decision-trees/ data-taxonomy-term=decision-trees><span class=taxonomy-label>decision trees</span><span class=taxonomy-count>1</span></a></li>
<li><a class=taxonomy-term href=/tags/expert-systems/ data-taxonomy-term=expert-systems><span class=taxonomy-label>expert systems</span><span class=taxonomy-count>1</span></a></li>
<li><a class=taxonomy-term href=/tags/numpy/ data-taxonomy-term=numpy><span class=taxonomy-label>numpy</span><span class=taxonomy-count>1</span></a></li>
<li><a class=taxonomy-term href=/tags/pandas/ data-taxonomy-term=pandas><span class=taxonomy-label>pandas</span><span class=taxonomy-count>1</span></a></li>
<li><a class=taxonomy-term href=/tags/performance/ data-taxonomy-term=performance><span class=taxonomy-label>performance</span><span class=taxonomy-count>2</span></a></li>
<li><a class=taxonomy-term href=/tags/q-learning/ data-taxonomy-term=q-learning><span class=taxonomy-label>q-learning</span><span class=taxonomy-count>1</span></a></li>
<li><a class=taxonomy-term href=/tags/rewards/ data-taxonomy-term=rewards><span class=taxonomy-label>rewards</span><span class=taxonomy-count>1</span></a></li>
<li><a class=taxonomy-term href=/tags/rnn/ data-taxonomy-term=rnn><span class=taxonomy-label>rnn</span><span class=taxonomy-count>1</span></a></li>
<li><a class=taxonomy-term href=/tags/spicepod/ data-taxonomy-term=spicepod><span class=taxonomy-label>spicepod</span><span class=taxonomy-count>3</span></a></li>
<li><a class=taxonomy-term href=/tags/td-learning/ data-taxonomy-term=td-learning><span class=taxonomy-label>td-learning</span><span class=taxonomy-count>1</span></a></li>
<li><a class=taxonomy-term href=/tags/tensors/ data-taxonomy-term=tensors><span class=taxonomy-label>tensors</span><span class=taxonomy-count>1</span></a></li>
<li><a class=taxonomy-term href=/tags/training/ data-taxonomy-term=training><span class=taxonomy-label>training</span><span class=taxonomy-count>1</span></a></li>
<li><a class=taxonomy-term href=/tags/transformers/ data-taxonomy-term=transformers><span class=taxonomy-label>transformers</span><span class=taxonomy-count>1</span></a></li>
<li><a class=taxonomy-term href=/tags/upgrade/ data-taxonomy-term=upgrade><span class=taxonomy-label>upgrade</span><span class=taxonomy-count>2</span></a></li>
</ul>
</div>
</aside>
<main class="col-12 col-md-9 col-xl-8 pl-md-5 pr-md-4" role=main>
<div class=td-content>
<h1>Adding Soft Actor-Critic</h1>
<div class="td-byline mb-4">
By <b>Corentin Risselin</b> |
<time datetime=2022-01-12 class=text-muted>Wednesday, January 12, 2022</time>
</div>
<header class=article-meta>
<div class="taxonomy taxonomy-terms-article taxo-categories">
<h5 class=taxonomy-title>Categories:</h5>
<ul class=taxonomy-terms>
<li><a class=taxonomy-term href=/categories/reinforcement-learning/ data-taxonomy-term=reinforcement-learning><span class=taxonomy-label>reinforcement learning</span></a></li>
<li><a class=taxonomy-term href=/categories/deep-learning/ data-taxonomy-term=deep-learning><span class=taxonomy-label>deep learning</span></a></li>
</ul>
</div>
<div class="taxonomy taxonomy-terms-article taxo-tags">
<h5 class=taxonomy-title>Tags:</h5>
<ul class=taxonomy-terms>
<li><a class=taxonomy-term href=/tags/actor-critic/ data-taxonomy-term=actor-critic><span class=taxonomy-label>actor-critic</span></a></li>
</ul>
</div>
</header>
<p>Last month in the v0.5-alpha version, a new learning algorithm was added to Spice.ai: Soft Actor-Critic. This is a very popular algorithm in the Reinforcement Learning field. Let&rsquo;s see what it is and why this is an interesting addition.</p>
<p>The previous article <a href=/posts/2021/12/15/understanding-q-learning-how-a-reward-is-all-you-need/>Understanding Q-learning: How a Reward Is All You Need</a> is not necessary but can be helpful to understand this article.</p>
<h2 id=what-is-soft-actor-critic>What is Soft Actor-Critic</h2>
<h3 id=actor-critic>Actor-Critic</h3>
<p>Deepmind first introduced the actor-critic approach in deep learning in a <a href=https://arxiv.org/abs/1602.01783>2016 paper</a>. We can think of this approach as having 2 tasks:</p>
<ul>
<li>Choosing actions to take: giving probabilities for each possible action (the policy)</li>
<li>Evaluating values for each action: the estimated reward from those actions (the Q-values)</li>
</ul>
<p>Those tasks will be made by 2 different neural networks or a single network that branches out in 2 heads. The actor is the part that outputs the policy, while the critic outputs the values.</p>
<div style=display:flex;justify-content:center;padding:5px>
<div style=display:flex;flex-direction:column>
<img style=max-width:300px;margin:auto alt="Actor-Critic Diagram" src=https://user-images.githubusercontent.com/19952490/148524970-e5fab55c-7364-4cb9-870c-7f5b8b58cc6f.png>
<div style=font-size:.8rem;font-style:italic;text-align:center>Figure 1. Actor-Critic struture</div>
</div>
</div>
<p>In most cases, this model was proven to perform very well, better than Deep Q-Learning. The actor is trained to prefer actions associated with the best values from the critic. The critic is trained to correctly estimate rewards (current and future ones) of the actions.</p>
<p>Both will improve over time though we have to keep in mind that the critic is unlikely to evaluate all possible actions in the environment as it will only see actions from states that the actor is likely to take (the policy).</p>
<p>This bias of the system toward its policy is important: the algorithm is meant to train <em>on-policy</em>. The duo actor-critic works together: trying to train it with inputs and outputs from another system (humans or even itself in past iterations of its own training) will not work.</p>
<p>Multiple improvements were made to limit the bias of the actor-critic approach but the necessity to train on-policy remains. This is very limiting as being able to train from any experience can be very valuable for time and data efficiency.</p>
<h3 id=soft-actor-critic>Soft Actor-Critic</h3>
<p>Soft Actor-Critic allows an Actor-Critic network to train off-policy. It was introduced in <a href=https://arxiv.org/abs/1801.01290>a paper</a> in 2018 and included multiple additions to improve its parent algorithm. The main difference is the introduction of the entropy of the actor outputs during the training phase.</p>
<p>The entropy measures the chaos/order of a system (or uncertainty). If a system always acts the same way, the entropy is minimal. Here the actor&rsquo;s entropy is maximum if all possible actions have the same weight (same probability) and minimum if the actor always chose only a single action with 100% confidence.</p>
<p>During the training phase, the actor is trained to maintain the entropy of its outputs at a specific value.</p>
<p>The introduction of the entropy changes the goal of the training not only to find the bests output but to keep exploring the other actions. The critic part will be trained on all actions, even if they may occur only in rare cases.</p>
<p>There are other essential parts, such as having 2 critics and being able to output continuous values, but the entropy is the crucial difference in this algorithm&rsquo;s training and potential.</p>
<h2 id=adding-choices-to-spiceai-learning-algorithms>Adding choices to Spice.AI learning algorithms</h2>
<p>As we saw above, the Actor-Critic algorithm is known to outperform Deep Q-Learning in most cases. If we also want to leverage previous data (off-policy training), Soft Actor-Critic is a natural choice. This approach is heavier despite better theoretical results, making it more suitable for complex tasks. For simpler tasks, Deep Q-Learning will still be an appealing option for its speed of training and its capability to quickly convergence to a good solution.</p>
<p>We can think of Soft Actor-Critic as a complex machine designed to take actions while keeping a variety of possibilities. Sometimes several options seem equally rewarding: a simpler algorithm would take what it evaluates as the best one even though the margin is small and the precision of its evaluation shouldn&rsquo;t be enough. This tendency to quickly convergence to a solution has its benefits and inconveniences.</p>
<h2 id=implementation-in-the-source-code>Implementation in the source code</h2>
<p>Adding new algorithms is essential to Spice.ai, so the procedure was designed to be straightforward.</p>
<p>Looking a the <a href=https://github.com/spiceai/spiceai>source code</a>, the code related to training agents is in the <code>ai/src</code> folder. This part of the code uses the python language as most modern AI libraries are distributed in this language.</p>
<p>In this folder, every agent is in the <code>algorithms</code> folder, and each has its subfolder. There is an <code>agent_interface</code> file that defines the main class that the different agents should inherit from and a <code>factory</code> script responsible for creating instances of an agent from a given algorithm name.</p>
<p>Adding a new agent is simple:</p>
<ul>
<li>making a new folder in the <code>algorithms</code></li>
<li>adding a json file describing the <code>algorithm_id</code>, <code>name</code>, and <code>docs_link</code> (see other json as an example) in the folder</li>
<li>adding a new python file with a class that would inherit from the <code>SpiceAIAgent</code> defined in the <code>agent_interface</code> script</li>
<li>adding a line in the <code>factory</code> script to instantiate the new implementation when its name is called.</li>
</ul>
<p>For the new agent, inheriting from the main <code>SpiceAIAgent</code> class, 5 functions need to be implemented:</p>
<ul>
<li><strong>add_experience</strong>: storing inputs and outputs (used during the training)</li>
<li><strong>act</strong>: returning the action to be taken from a given input</li>
<li><strong>save</strong>: saving the agent to a given a path</li>
<li><strong>load</strong>: restoring the agent from a given path</li>
<li><strong>learn</strong>: train iteration (from the accumulated experiences)</li>
</ul>
<h2 id=conclusion>Conclusion</h2>
<p>Soft Actor-Critic is a fascinating algorithm that performs well in complex environments. We now <a href=/posts/2021/12/06/announcing-the-release-of-spice.ai-v0.5-alpha/>support Soft Actor Critic</a> in Spice.ai, which is another step forward in constantly improving the performance of the AI engine. Additionally, we&rsquo;ll continue improving existing algorithms and adding newer ones over time. We designed the platform for ease of implementation and experimentation so if you&rsquo;d like to try building your own agent, you can get the source code on <a href=https://github.com/spiceai/spiceai>Github</a> and contribute to the platform. Say hi on <a href=https://discord.gg/kZnTfneP5u>Discord</a>, reach out on <a href=https://twitter.com/SpiceAIHQ>Twitter</a> or <a href=mailto:hey@spiceai.io>email us</a>.</p>
<p>I hope you enjoy this post and something new.</p>
<p>Corentin</p>
<ul class="list-unstyled d-flex justify-content-between align-items-center mb-0 pt-5">
<li>
<a href=/posts/2022/01/04/what-data-informs-ai-driven-decision-making/ aria-label="Previous - What Data Informs AI-driven Decision Making?" class="btn btn-primary"><span class=mr-1>←</span> Previous</a>
</li>
<a href=/posts/2022/02/08/announcing-the-release-of-spice.ai-v0.6-alpha/ aria-label="Next - Announcing the release of Spice.ai v0.6-alpha" class="btn btn-primary">Next <span class=ml-1>→</span></a>
</li>
</ul>
</div>
</main>
</div>
</div>
<footer class="bg-dark py-5 row d-print-none">
<div class="container-fluid mx-sm-5">
<div class=row>
<div class="col-6 col-sm-4 text-xs-center order-sm-2">
</div>
<div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter>
<a class=text-white target=_blank rel=noopener href=https://twitter.com/SpiceAIHQ aria-label=Twitter>
<i class="fab fa-twitter"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Discord aria-label=Discord>
<a class=text-white target=_blank rel=noopener href=https://discord.com/channels/803820740868571196/803820740868571199 aria-label=Discord>
<i class="fab fa-discord"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Reddit aria-label=Reddit>
<a class=text-white target=_blank rel=noopener href=https://reddit.com/r/spiceai aria-label=Reddit>
<i class="fab fa-reddit"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub>
<a class=text-white target=_blank rel=noopener href=https://github.com/spiceai/spiceai aria-label=GitHub>
<i class="fab fa-github"></i>
</a>
</li>
</ul>
</div>
<div class="col-12 col-sm-4 text-center py-2 order-sm-2">
<small class=text-white>&copy; 2022 Spice AI, Inc. All Rights Reserved</small>
</div>
</div>
</div>
</footer>
</div>
<script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.5c74b870c6953931a705f390a49c7e4c0a842ec5c83b24354758dd674343ed0d.js integrity="sha256-XHS4cMaVOTGnBfOQpJx+TAqELsXIOyQ1R1jdZ0ND7Q0=" crossorigin=anonymous></script>
</body>
</html>